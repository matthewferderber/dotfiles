#!/bin/zsh
#
# dot_update
#
# `dot_update` handles installation, updates, things like that. Run it
# periodically to make sure you're on the latest and greatest.
export DOTFILES="$HOME/src/github.com/ferderber/dotfiles"
cd "$DOTFILES" || exit 1

if command -v brew >/dev/null 2>&1; then
  echo $PATH
  export PATH=$(brew --prefix)/bin:$(brew --prefix)/sbin:$PATH
  [[ -x /opt/homebrew/bin/brew ]] && eval $(/opt/homebrew/bin/brew shellenv)
fi

# load custom config if any
# shellcheck disable=SC1090
[ -f ~/.localrc ] && . ~/.localrc

# Run all installs
echo "› $DOTFILES/script/install"
"$DOTFILES/script/install"

if command -v antidote >/dev/null 2>&1; then
	echo "› antidote update"
	antidote update
fi

echo "› registering last update"
git config --global dotfiles.lastupdate "$(date +%Y%m%d%H%M)"
